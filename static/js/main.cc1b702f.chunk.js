(this["webpackJsonpidx-demo-app"]=this["webpackJsonpidx-demo-app"]||[]).push([[0],{147:function(t){t.exports=JSON.parse('{"a":{"notes":"kjzl6cwe1jw1472nj85wp2u8xpnsaugtbsx9oi266s5p9mw7f5ndf08715q0458"},"b":{"Note":"ceramic://k3y52l7qbv1frym2pwdo19pqq8p7rvrynq25kj7d24d3l0lwd1odzoxlvevrr5534","NotesList":"ceramic://k3y52l7qbv1frybwerbfa6fu5s5291x7wgyliavkatp0dnprlb7bvomxk4gzqf6rk"}}')},331:function(t,e,a){},374:function(t,e){},375:function(t,e){},401:function(t,e){},403:function(t,e){},414:function(t,e){},416:function(t,e){},442:function(t,e){},444:function(t,e){},449:function(t,e){},451:function(t,e){},463:function(t,e){},466:function(t,e){},508:function(t,e){},516:function(t,e){function a(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}a.keys=function(){return[]},a.resolve=a,t.exports=a,a.id=516},579:function(t,e,a){"use strict";a.r(e);var n=a(12),c=a(0),s=a.n(c),r=a(28),o=a.n(r),i=(a(331),a(39)),u=a(25),d=a(651),l=a(644),j=a(650),b=a(645),f=a(649),O=a(647),h=a(646),v=a(643),p=a(656),x=a(654),m=a(641),g=a(642),y=a(637),w=a(640),D=a(639),k=a(316),N=a(648),I=a(653),C=a(652),S=a(120),F=a(633),P=a(655),T=a(35),B=a(312),q=a.n(B),M=a(311),R=a.n(M),L=a(199),z=a.n(L),A=a(197),U=a.n(A),E=a(638),J=a(314),X=a.n(J),_=a(313),G=a.n(_),W=a(200),V=a.n(W),Y=a(198),H=a.n(Y),K=a(45),Q=a(20),Z=a(147),$=a(4),tt=a.n($),et=a(303),at=a(142),nt=a.n(at),ct=a(193),st=a(196),rt=a(310),ot=a.n(rt),it="https://ceramic-dev.3boxlabs.com",ut=new st.ThreeIdConnect,dt=new ot.a({network:"mainnet",cacheProvider:!0});function lt(){return(lt=Object(et.a)(tt.a.mark((function t(){var e,a,n,c,s,r,o;return tt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,dt.connect();case 2:return a=t.sent,t.next=5,a.send("eth_requestAccounts");case 5:return n=t.sent,c=n.result,t.next=9,ut.connect(new st.EthereumAuthProvider(a,c[0]));case 9:return s=new nt.a(it),t.next=12,s.setDIDProvider(ut.getDidProvider());case 12:return r=new ct.IDX({ceramic:s,aliases:Z.a}),t.next=15,r.get("notes");case 15:return o=t.sent,t.abrupt("return",{ceramic:s,idx:r,notes:null!==(e=null===o||void 0===o?void 0:o.notes)&&void 0!==e?e:[]});case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function jt(t,e){switch(e.type){case"auth":return Object(Q.a)(Object(Q.a)({},t),{},{nav:{type:"default"},auth:{status:e.status}});case"auth success":var a={status:"done",ceramic:e.ceramic,idx:e.idx};return e.notes.length?Object(Q.a)(Object(Q.a)({},t),{},{auth:a,notes:e.notes.reduce((function(t,e){return t[e.id]={status:"init",title:e.title},t}),{})}):{auth:a,draftStatus:"unsaved",nav:{type:"draft"},notes:{}};case"nav reset":return Object(Q.a)(Object(Q.a)({},t),{},{nav:{type:"default"}});case"nav draft":return Object(Q.a)(Object(Q.a)({},t),{},{auth:t.auth,nav:{type:"draft"}});case"draft status":return Object(Q.a)(Object(Q.a)({},t),{},{auth:t.auth,draftStatus:e.status});case"draft delete":return Object(Q.a)(Object(Q.a)({},t),{},{draftStatus:"unsaved",nav:{type:"default"}});case"draft saved":return{auth:t.auth,draftStatus:"unsaved",nav:{type:"note",docID:e.docID},notes:Object(Q.a)(Object(Q.a)({},t.notes),{},Object(u.a)({},e.docID,{status:"saved",title:e.title,doc:e.doc}))};case"nav note":return Object(Q.a)(Object(Q.a)({},t),{},{auth:t.auth,nav:{type:"note",docID:e.docID}});case"note loaded":var n=t.nav.docID,c=t.notes[n];return Object(Q.a)(Object(Q.a)({},t),{},{auth:t.auth,notes:Object(Q.a)(Object(Q.a)({},t.notes),{},Object(u.a)({},n,{status:"loaded",title:c.title,doc:e.doc}))});case"note loading status":var s=t.nav.docID,r=t.notes[s];return Object(Q.a)(Object(Q.a)({},t),{},{auth:t.auth,notes:Object(Q.a)(Object(Q.a)({},t.notes),{},Object(u.a)({},s,Object(Q.a)(Object(Q.a)({},r),{},{status:e.status})))});case"note saving status":var o=t.nav.docID,i=t.notes[o];return Object(Q.a)(Object(Q.a)({},t),{},{auth:t.auth,notes:Object(Q.a)(Object(Q.a)({},t.notes),{},Object(u.a)({},o,Object(Q.a)(Object(Q.a)({},i),{},{status:e.status})))})}}function bt(){var t=Object(c.useReducer)(jt,{auth:{status:"pending"},draftStatus:"unsaved",nav:{type:"default"},notes:{}}),e=Object(i.a)(t,2),a=e[0],n=e[1],s=Object(c.useCallback)((function(){n({type:"auth",status:"loading"}),function(){return lt.apply(this,arguments)}().then((function(t){n(Object(Q.a)({type:"auth success"},t))}),(function(t){console.warn("authenticate call failed",t),n({type:"auth",status:"failed"})}))}),[]),r=Object(c.useCallback)((function(){n({type:"nav draft"})}),[]),o=Object(c.useCallback)((function(){n({type:"draft delete"})}),[]),u=Object(c.useCallback)((function(t,e){n({type:"draft status",status:"saving"});var c=a.auth,s=c.ceramic,r=c.idx;Promise.all([s.createDocument("tile",{content:{date:(new Date).toISOString(),text:e},metadata:{controllers:[r.id],schema:Z.b.Note}}),r.get("notes")]).then((function(e){var a,c=Object(i.a)(e,2),s=c[0],o=c[1],u=null!==(a=null===o||void 0===o?void 0:o.notes)&&void 0!==a?a:[];return r.set("notes",{notes:[{id:s.id.toUrl(),title:t}].concat(Object(K.a)(u))}).then((function(){var e=s.id.toString();n({type:"draft saved",docID:e,title:t,doc:s})}))})).catch((function(t){console.log("failed to save draft",t),n({type:"draft status",status:"failed"})}))}),[a.auth]);return{authenticate:s,deleteDraft:o,openDraft:r,openNote:Object(c.useCallback)((function(t){(n({type:"nav note",docID:t}),null==a.notes[t]||"init"===a.notes[t].status)&&a.auth.ceramic.loadDocument(t).then((function(e){n({type:"note loaded",docID:t,doc:e})}),(function(){n({type:"note loading status",docID:t,status:"loading failed"})}))}),[a.auth,a.notes]),saveDraft:u,saveNote:Object(c.useCallback)((function(t,e){var a=t.id.toString();n({type:"note saving status",docID:a,status:"saving"}),t.change({content:{date:(new Date).toUTCString(),text:e}}).then((function(){n({type:"note saving status",docID:a,status:"saved"})}),(function(){n({type:"note saving status",docID:a,status:"saving failed"})}))}),[]),state:a}}var ft=300,Ot=Object(F.a)((function(t){return Object(P.a)({root:{display:"flex"},drawer:Object(u.a)({},t.breakpoints.up("sm"),{width:ft,flexShrink:0}),appBar:Object(u.a)({},t.breakpoints.up("sm"),{width:"calc(100% - ".concat(ft,"px)"),marginLeft:ft}),menuButton:Object(u.a)({marginRight:t.spacing(2)},t.breakpoints.up("sm"),{display:"none"}),toolbar:t.mixins.toolbar,drawerPaper:{width:ft},content:{flexGrow:1,padding:t.spacing(3)},title:{flexGrow:1},noteSaveButton:{marginTop:t.spacing(2)},noteTextarea:{border:0,fontSize:t.typography.pxToRem(18),padding:t.spacing(2),width:"100%"}})}));function ht(t){var e,a=t.authenticate,c=t.deleteDraft,s=t.openDraft,r=t.openNote,o=t.state;if("draft"===o.nav.type){var u;switch(o.draftStatus){case"failed":u=Object(n.jsx)(U.a,{});break;case"saving":u=Object(n.jsx)(H.a,{});break;default:u=Object(n.jsx)(z.a,{})}e=Object(n.jsxs)(y.a,{button:!0,onClick:function(){return s()},selected:!0,children:[Object(n.jsx)(E.a,{children:u}),Object(n.jsx)(D.a,{primary:"Draft note"}),Object(n.jsx)(w.a,{children:Object(n.jsx)(m.a,{edge:"end","aria-label":"delete",onClick:function(){return c()},children:Object(n.jsx)(R.a,{})})})]})}else e="done"===o.auth.status?Object(n.jsxs)(y.a,{button:!0,onClick:function(){return s()},children:[Object(n.jsx)(E.a,{children:Object(n.jsx)(V.a,{})}),Object(n.jsx)(D.a,{primary:"New note"})]}):Object(n.jsxs)(y.a,{button:!0,onClick:function(){return a()},children:[Object(n.jsx)(E.a,{children:Object(n.jsx)(V.a,{})}),Object(n.jsx)(D.a,{primary:"Authenticate to create note"})]});var d=Object.entries(o.notes).map((function(t){var e,a=Object(i.a)(t,2),c=a[0],s=a[1],u="note"===o.nav.type&&o.nav.docID===c;switch(s.status){case"loading failed":case"saving failed":e=Object(n.jsx)(U.a,{});break;case"loading":e=Object(n.jsx)(q.a,{});break;case"saving":e=Object(n.jsx)(H.a,{});break;default:e=u?Object(n.jsx)(z.a,{}):Object(n.jsx)(G.a,{})}return Object(n.jsxs)(y.a,{button:!0,onClick:function(){return r(c)},selected:u,children:[Object(n.jsx)(E.a,{children:e}),Object(n.jsx)(D.a,{primary:s.title})]},c)}));return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(g.a,{children:e}),Object(n.jsx)(v.a,{}),Object(n.jsx)(g.a,{children:d})]})}function vt(t){var e=t.authenticate,a=t.state;return"done"===a.status?Object(n.jsxs)(S.a,{children:["Authenticated with ID ",a.idx.id]}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(S.a,{children:"You need to authenticate to load your existing notes and create new ones."}),Object(n.jsx)(l.a,{color:"primary",disabled:"loading"===a.status,onClick:e,variant:"contained",children:"Authenticate"})]})}function pt(t){var e=t.save,a=t.status,s=Ot(),r=Object(c.useState)(!1),o=Object(i.a)(r,2),u=o[0],d=o[1],j=Object(c.useRef)(null),v=Object(c.useRef)(null),p=function(){d(!1)};return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)(b.a,{open:u,onClose:p,"aria-labelledby":"form-dialog-title",children:[Object(n.jsx)(h.a,{id:"form-dialog-title",children:"Save note"}),Object(n.jsx)(O.a,{children:Object(n.jsx)(I.a,{autoFocus:!0,margin:"dense",id:"title",label:"Note title",inputRef:v,type:"text",fullWidth:!0})}),Object(n.jsxs)(f.a,{children:[Object(n.jsx)(l.a,{onClick:p,color:"primary",children:"Cancel"}),Object(n.jsx)(l.a,{onClick:function(){var t,a,n=null===(t=j.current)||void 0===t?void 0:t.value,c=null===(a=v.current)||void 0===a?void 0:a.value;n&&c&&e(c,n),d(!1)},color:"primary",variant:"outlined",children:"Save note"})]})]}),Object(n.jsx)(k.a,{elevation:5,children:Object(n.jsx)(N.a,{className:s.noteTextarea,disabled:"saving"===a,placeholder:"Note contents...",ref:j,rowsMin:10,rowsMax:20})}),Object(n.jsx)(l.a,{className:s.noteSaveButton,color:"primary",disabled:"saving"===a,onClick:function(){d(!0)},variant:"contained",children:"Save"})]})}function xt(t){var e=t.note,a=t.save,s=Ot(),r=Object(c.useRef)(null);if("loading failed"===e.status)return Object(n.jsx)(S.a,{children:"Failed to load note!"});if("init"===e.status||"loading"===e.status)return Object(n.jsx)(S.a,{children:"Loading note..."});var o=e.doc;return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(k.a,{elevation:5,children:Object(n.jsx)(N.a,{className:s.noteTextarea,disabled:"saving"===e.status,defaultValue:o.content.text,placeholder:"Note contents...",ref:r,rowsMin:10,rowsMax:20})}),Object(n.jsx)(l.a,{className:s.noteSaveButton,color:"primary",disabled:"saving"===e.status,onClick:function(){var t,e;return a(o,null!==(t=null===(e=r.current)||void 0===e?void 0:e.value)&&void 0!==t?t:"")},variant:"contained",children:"Save"})]})}function mt(){var t,e=bt(),a=Ot(),s=Object(T.a)(),r=Object(c.useState)(!1),o=Object(i.a)(r,2),u=o[0],b=o[1],f=function(){b(!u)},O=Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:a.toolbar}),Object(n.jsx)(ht,{authenticate:e.authenticate,deleteDraft:e.deleteDraft,openDraft:e.openDraft,openNote:e.openNote,state:e.state})]});switch(e.state.nav.type){case"draft":t=Object(n.jsx)(pt,{save:e.saveDraft,status:e.state.draftStatus});break;case"note":t=Object(n.jsx)(xt,{note:e.state.notes[e.state.nav.docID],save:e.saveNote},e.state.nav.docID);break;default:t=Object(n.jsx)(vt,{authenticate:e.authenticate,state:e.state.auth})}return Object(n.jsxs)("div",{className:a.root,children:[Object(n.jsx)(j.a,{}),Object(n.jsx)(d.a,{position:"fixed",className:a.appBar,children:Object(n.jsxs)(C.a,{children:[Object(n.jsx)(m.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:f,className:a.menuButton,children:Object(n.jsx)(X.a,{})}),Object(n.jsx)(S.a,{className:a.title,noWrap:!0,variant:"h6",children:"IDX demo notes app"}),Object(n.jsx)(l.a,{color:"inherit",href:"https://idx.xyz",variant:"outlined",children:"IDX"})]})}),Object(n.jsxs)("nav",{className:a.drawer,"aria-label":"notes",children:[Object(n.jsx)(x.a,{smUp:!0,implementation:"css",children:Object(n.jsx)(p.a,{variant:"temporary",anchor:"rtl"===s.direction?"right":"left",open:u,onClose:f,classes:{paper:a.drawerPaper},ModalProps:{keepMounted:!0},children:O})}),Object(n.jsx)(x.a,{xsDown:!0,implementation:"css",children:Object(n.jsx)(p.a,{classes:{paper:a.drawerPaper},variant:"permanent",open:!0,children:O})})]}),Object(n.jsxs)("main",{className:a.content,children:[Object(n.jsx)("div",{className:a.toolbar}),t]})]})}var gt=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,657)).then((function(e){var a=e.getCLS,n=e.getFID,c=e.getFCP,s=e.getLCP,r=e.getTTFB;a(t),n(t),c(t),s(t),r(t)}))};o.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(mt,{})}),document.getElementById("root")),gt()}},[[579,1,2]]]);
//# sourceMappingURL=main.cc1b702f.chunk.js.map