(this["webpackJsonpidx-demo-app"]=this["webpackJsonpidx-demo-app"]||[]).push([[0],{105:function(t){t.exports=JSON.parse('{"a":{"notes":"kjzl6cwe1jw14a8kbrozwohwck4b9lbqwgu38x5nriozyqtor09ihdl9nuh7nx9"},"b":{"Note":"ceramic://k3y52l7qbv1frxti2zyi8svr4mxvs16ipdb599pydp9058udwlg9kzhl0eqe9t2ps","NotesList":"ceramic://k3y52l7qbv1fry4279vhf5zo9ukmnaky1f7gtekzevsc9thgnfu3fka9rmyv9glq8"}}')},253:function(t,e,a){},260:function(t,e){},262:function(t,e){},273:function(t,e){},275:function(t,e){},301:function(t,e){},303:function(t,e){},304:function(t,e){},309:function(t,e){},311:function(t,e){},330:function(t,e){},342:function(t,e){},345:function(t,e){},488:function(t,e,a){"use strict";a.r(e);var n=a(4),c=a(0),s=a.n(c),r=a(14),o=a.n(r),i=(a(253),a(26)),u=a(13),d=a(557),l=a(551),j=a(556),b=a(552),O=a(555),f=a(554),h=a(553),v=a(549),p=a(562),x=a(560),g=a(547),m=a(548),y=a(543),k=a(546),w=a(545),D=a(239),S=a(550),I=a(559),N=a(558),C=a(87),F=a(539),B=a(561),z=a(22),P=a(234),M=a.n(P),R=a(233),T=a.n(R),q=a(142),L=a.n(q),A=a(140),G=a.n(A),J=a(544),W=a(236),U=a.n(W),X=a(235),E=a.n(X),V=a(143),Y=a.n(V),H=a(141),K=a.n(H),Q=a(66),Z=a(139),$=a(38),_=a(10),tt=a(105),et=a(20),at=a.n(et),nt=a(227),ct=a(228),st=a.n(ct),rt=a(237),ot=a(231),it="http://localhost:7007";function ut(){return(ut=Object(nt.a)(at.a.mark((function t(e){var a,n,c,s;return at.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new st.a(it),t.next=3,n.setDIDProvider(new ot.a(e));case 3:return c=new rt.a({ceramic:n,aliases:tt.a}),t.next=6,c.get("notes");case 6:return s=t.sent,t.abrupt("return",{ceramic:n,idx:c,notes:null!==(a=null===s||void 0===s?void 0:s.notes)&&void 0!==a?a:[]});case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function dt(t,e){switch(e.type){case"auth":return Object(_.a)(Object(_.a)({},t),{},{nav:{type:"default"},auth:{status:e.status}});case"auth success":var a={status:"done",ceramic:e.ceramic,idx:e.idx};return e.notes.length?Object(_.a)(Object(_.a)({},t),{},{auth:a,notes:e.notes.reduce((function(t,e){return t[e.id]={status:"init",title:e.title},t}),{})}):{auth:a,draftStatus:"unsaved",nav:{type:"draft"},notes:{}};case"nav reset":return Object(_.a)(Object(_.a)({},t),{},{nav:{type:"default"}});case"nav draft":return Object(_.a)(Object(_.a)({},t),{},{auth:t.auth,nav:{type:"draft"}});case"draft status":return Object(_.a)(Object(_.a)({},t),{},{auth:t.auth,draftStatus:e.status});case"draft delete":return Object(_.a)(Object(_.a)({},t),{},{draftStatus:"unsaved",nav:{type:"default"}});case"draft saved":return{auth:t.auth,draftStatus:"unsaved",nav:{type:"note",docID:e.docID},notes:Object(_.a)(Object(_.a)({},t.notes),{},Object(u.a)({},e.docID,{status:"saved",title:e.title,doc:e.doc}))};case"nav note":return Object(_.a)(Object(_.a)({},t),{},{auth:t.auth,nav:{type:"note",docID:e.docID}});case"note loaded":var n=t.nav.docID,c=t.notes[n];return Object(_.a)(Object(_.a)({},t),{},{auth:t.auth,notes:Object(_.a)(Object(_.a)({},t.notes),{},Object(u.a)({},n,{status:"loaded",title:c.title,doc:e.doc}))});case"note loading status":var s=t.nav.docID,r=t.notes[s];return Object(_.a)(Object(_.a)({},t),{},{auth:t.auth,notes:Object(_.a)(Object(_.a)({},t.notes),{},Object(u.a)({},s,Object(_.a)(Object(_.a)({},r),{},{status:e.status})))});case"note saving status":var o=t.nav.docID,i=t.notes[o];return Object(_.a)(Object(_.a)({},t),{},{auth:t.auth,notes:Object(_.a)(Object(_.a)({},t.notes),{},Object(u.a)({},o,Object(_.a)(Object(_.a)({},i),{},{status:e.status})))})}}function lt(){var t=Object(c.useReducer)(dt,{auth:{status:"pending"},draftStatus:"unsaved",nav:{type:"default"},notes:{}}),e=Object(i.a)(t,2),a=e[0],n=e[1],s=Object(c.useCallback)((function(t){n({type:"auth",status:"loading"}),function(t){return ut.apply(this,arguments)}(t).then((function(t){n(Object(_.a)({type:"auth success"},t))}),(function(t){console.warn("authenticate call failed",t),n({type:"auth",status:"failed"})}))}),[]),r=Object(c.useCallback)((function(){n({type:"nav draft"})}),[]),o=Object(c.useCallback)((function(){n({type:"draft delete"})}),[]),u=Object(c.useCallback)((function(t,e){n({type:"draft status",status:"saving"});var c=a.auth,s=c.ceramic,r=c.idx;Promise.all([s.createDocument("tile",{content:{date:(new Date).toISOString(),text:e},metadata:{controllers:[r.id],schema:tt.b.Note}}),r.get("notes")]).then((function(e){var a,c=Object(i.a)(e,2),s=c[0],o=c[1],u=null!==(a=null===o||void 0===o?void 0:o.notes)&&void 0!==a?a:[];return r.set("notes",{notes:[{id:s.id.toUrl(),title:t}].concat(Object($.a)(u))}).then((function(){var e=s.id.toString();n({type:"draft saved",docID:e,title:t,doc:s})}))})).catch((function(t){console.log("failed to save draft",t),n({type:"draft status",status:"failed"})}))}),[a.auth]);return{authenticate:s,deleteDraft:o,openDraft:r,openNote:Object(c.useCallback)((function(t){(n({type:"nav note",docID:t}),null==a.notes[t]||"init"===a.notes[t].status)&&a.auth.ceramic.loadDocument(t).then((function(e){n({type:"note loaded",docID:t,doc:e})}),(function(){n({type:"note loading status",docID:t,status:"loading failed"})}))}),[a.auth,a.notes]),saveDraft:u,saveNote:Object(c.useCallback)((function(t,e){var a=t.id.toString();n({type:"note saving status",docID:a,status:"saving"}),t.change({content:{date:(new Date).toISOString(),text:e}}).then((function(){n({type:"note saving status",docID:a,status:"saved"})}),(function(){n({type:"note saving status",docID:a,status:"saving failed"})}))}),[]),state:a}}var jt=300,bt=Object(F.a)((function(t){return Object(B.a)({root:{display:"flex"},drawer:Object(u.a)({},t.breakpoints.up("sm"),{width:jt,flexShrink:0}),appBar:Object(u.a)({},t.breakpoints.up("sm"),{width:"calc(100% - ".concat(jt,"px)"),marginLeft:jt}),menuButton:Object(u.a)({marginRight:t.spacing(2)},t.breakpoints.up("sm"),{display:"none"}),toolbar:t.mixins.toolbar,drawerPaper:{width:jt},content:{flexGrow:1,padding:t.spacing(3)},title:{flexGrow:1},noteSaveButton:{marginTop:t.spacing(2)},noteTextarea:{border:0,fontSize:t.typography.pxToRem(18),padding:t.spacing(2),width:"100%"}})}));function Ot(t){var e,a=t.deleteDraft,c=t.openDraft,s=t.openNote,r=t.state;if("draft"===r.nav.type){var o;switch(r.draftStatus){case"failed":o=Object(n.jsx)(G.a,{});break;case"saving":o=Object(n.jsx)(K.a,{});break;default:o=Object(n.jsx)(L.a,{})}e=Object(n.jsxs)(y.a,{button:!0,onClick:function(){return c()},selected:!0,children:[Object(n.jsx)(J.a,{children:o}),Object(n.jsx)(w.a,{primary:"Draft note"}),Object(n.jsx)(k.a,{children:Object(n.jsx)(g.a,{edge:"end","aria-label":"delete",onClick:function(){return a()},children:Object(n.jsx)(T.a,{})})})]})}else e="done"===r.auth.status?Object(n.jsxs)(y.a,{button:!0,onClick:function(){return c()},children:[Object(n.jsx)(J.a,{children:Object(n.jsx)(Y.a,{})}),Object(n.jsx)(w.a,{primary:"New note"})]}):Object(n.jsxs)(y.a,{children:[Object(n.jsx)(J.a,{children:Object(n.jsx)(Y.a,{})}),Object(n.jsx)(w.a,{primary:"Authenticate to create note"})]});var u=Object.entries(r.notes).map((function(t){var e,a=Object(i.a)(t,2),c=a[0],o=a[1],u="note"===r.nav.type&&r.nav.docID===c;switch(o.status){case"loading failed":case"saving failed":e=Object(n.jsx)(G.a,{});break;case"loading":e=Object(n.jsx)(M.a,{});break;case"saving":e=Object(n.jsx)(K.a,{});break;default:e=u?Object(n.jsx)(L.a,{}):Object(n.jsx)(E.a,{})}return Object(n.jsxs)(y.a,{button:!0,onClick:function(){return s(c)},selected:u,children:[Object(n.jsx)(J.a,{children:e}),Object(n.jsx)(w.a,{primary:o.title})]},c)}));return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(m.a,{children:e}),Object(n.jsx)(v.a,{}),Object(n.jsx)(m.a,{children:u})]})}function ft(t){var e=t.authenticate,a=t.state,s=Object(c.useState)(""),r=Object(i.a)(s,2),o=r[0],u=r[1],d="loading"===a.status;return"done"===a.status?Object(n.jsxs)(C.a,{children:["Authenticated with ID ",a.idx.id]}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(C.a,{children:"You need to authenticate to load your existing notes and create new ones."}),Object(n.jsx)("div",{children:Object(n.jsx)(I.a,{autoFocus:!0,disabled:d,fullWidth:!0,id:"seed",label:"Seed",onChange:function(t){return u(t.target.value)},placeholder:"base16-encoded string of 32 bytes length",type:"text",value:o})}),Object(n.jsx)(l.a,{color:"primary",disabled:""===o||d,onClick:function(){return e(Object(Z.fromString)(o,"base16"))},variant:"contained",children:"Authenticate"}),Object(n.jsx)(l.a,{color:"primary",disabled:d,onClick:function(){return u(Object(Z.toString)(Object(Q.randomBytes)(32),"base16"))},children:"Generate random seed"})]})}function ht(t){var e=t.save,a=t.status,s=bt(),r=Object(c.useState)(!1),o=Object(i.a)(r,2),u=o[0],d=o[1],j=Object(c.useRef)(null),v=Object(c.useRef)(null),p=function(){d(!1)};return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)(b.a,{open:u,onClose:p,"aria-labelledby":"form-dialog-title",children:[Object(n.jsx)(h.a,{id:"form-dialog-title",children:"Save note"}),Object(n.jsx)(f.a,{children:Object(n.jsx)(I.a,{autoFocus:!0,margin:"dense",id:"title",label:"Note title",inputRef:v,type:"text",fullWidth:!0})}),Object(n.jsxs)(O.a,{children:[Object(n.jsx)(l.a,{onClick:p,color:"primary",children:"Cancel"}),Object(n.jsx)(l.a,{onClick:function(){var t,a,n=null===(t=j.current)||void 0===t?void 0:t.value,c=null===(a=v.current)||void 0===a?void 0:a.value;n&&c&&e(c,n),d(!1)},color:"primary",variant:"outlined",children:"Save note"})]})]}),Object(n.jsx)(D.a,{elevation:5,children:Object(n.jsx)(S.a,{className:s.noteTextarea,disabled:"saving"===a,placeholder:"Note contents...",ref:j,rowsMin:10,rowsMax:20})}),Object(n.jsx)(l.a,{className:s.noteSaveButton,color:"primary",disabled:"saving"===a,onClick:function(){d(!0)},variant:"contained",children:"Save"})]})}function vt(t){var e=t.note,a=t.save,s=bt(),r=Object(c.useRef)(null);if("loading failed"===e.status)return Object(n.jsx)(C.a,{children:"Failed to load note!"});if("init"===e.status||"loading"===e.status)return Object(n.jsx)(C.a,{children:"Loading note..."});var o=e.doc;return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(D.a,{elevation:5,children:Object(n.jsx)(S.a,{className:s.noteTextarea,disabled:"saving"===e.status,defaultValue:o.content.text,placeholder:"Note contents...",ref:r,rowsMin:10,rowsMax:20})}),Object(n.jsx)(l.a,{className:s.noteSaveButton,color:"primary",disabled:"saving"===e.status,onClick:function(){var t,e;return a(o,null!==(t=null===(e=r.current)||void 0===e?void 0:e.value)&&void 0!==t?t:"")},variant:"contained",children:"Save"})]})}function pt(){var t,e=lt(),a=bt(),s=Object(z.a)(),r=Object(c.useState)(!1),o=Object(i.a)(r,2),u=o[0],b=o[1],O=function(){b(!u)},f=Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:a.toolbar}),Object(n.jsx)(Ot,{deleteDraft:e.deleteDraft,openDraft:e.openDraft,openNote:e.openNote,state:e.state})]});switch(e.state.nav.type){case"draft":t=Object(n.jsx)(ht,{save:e.saveDraft,status:e.state.draftStatus});break;case"note":t=Object(n.jsx)(vt,{note:e.state.notes[e.state.nav.docID],save:e.saveNote},e.state.nav.docID);break;default:t=Object(n.jsx)(ft,{authenticate:e.authenticate,state:e.state.auth})}return Object(n.jsxs)("div",{className:a.root,children:[Object(n.jsx)(j.a,{}),Object(n.jsx)(d.a,{position:"fixed",className:a.appBar,children:Object(n.jsxs)(N.a,{children:[Object(n.jsx)(g.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:O,className:a.menuButton,children:Object(n.jsx)(U.a,{})}),Object(n.jsx)(C.a,{className:a.title,noWrap:!0,variant:"h6",children:"IDX demo notes app"}),Object(n.jsx)(l.a,{color:"inherit",href:"https://idx.xyz",variant:"outlined",children:"IDX"})]})}),Object(n.jsxs)("nav",{className:a.drawer,"aria-label":"notes",children:[Object(n.jsx)(x.a,{smUp:!0,implementation:"css",children:Object(n.jsx)(p.a,{variant:"temporary",anchor:"rtl"===s.direction?"right":"left",open:u,onClose:O,classes:{paper:a.drawerPaper},ModalProps:{keepMounted:!0},children:f})}),Object(n.jsx)(x.a,{xsDown:!0,implementation:"css",children:Object(n.jsx)(p.a,{classes:{paper:a.drawerPaper},variant:"permanent",open:!0,children:f})})]}),Object(n.jsxs)("main",{className:a.content,children:[Object(n.jsx)("div",{className:a.toolbar}),t]})]})}var xt=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,563)).then((function(e){var a=e.getCLS,n=e.getFID,c=e.getFCP,s=e.getLCP,r=e.getTTFB;a(t),n(t),c(t),s(t),r(t)}))};o.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(pt,{})}),document.getElementById("root")),xt()}},[[488,1,2]]]);
//# sourceMappingURL=main.b4dbafe9.chunk.js.map